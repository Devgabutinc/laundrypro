import{D as c,C as d,F as u,T as l}from"./index-Can26OEw.js";const g=async(r,i,t=c.Documents,s="application/octet-stream")=>{if(!d.isNativePlatform())try{const e=f(i,s),n=URL.createObjectURL(e),a=document.createElement("a");return a.href=n,a.download=r,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n),{success:!0}}catch(e){return console.error("Error downloading file in browser:",e),{success:!1,error:e instanceof Error?e.message:"Error downloading file"}}try{if(t===c.Data||t===c.Cache)return{success:!0,uri:(await u.writeFile({path:r,data:i,directory:t,recursive:!0})).uri};try{const e=await u.writeFile({path:r,data:i,directory:t,recursive:!0});return await l.show({text:`File berhasil disimpan: ${r}`,duration:"long"}),{success:!0,uri:e.uri}}catch(e){console.log("Direct write failed, trying fallback:",e);const n=await u.writeFile({path:r,data:i,directory:c.Cache,recursive:!0});return await l.show({text:"Untuk menyimpan file, Anda perlu memberikan izin penyimpanan secara manual.",duration:"long"}),await l.show({text:"Buka Pengaturan > Aplikasi > LaundryPro > Izin > Penyimpanan dan aktifkan.",duration:"long"}),{success:!0,uri:n.uri,error:"File disimpan ke penyimpanan internal aplikasi. Untuk menyimpan ke Documents, berikan izin penyimpanan."}}}catch(e){return console.error("Error saving file:",e),await l.show({text:"Gagal menyimpan file. Coba lagi nanti.",duration:"long"}),{success:!1,error:e instanceof Error?e.message:"Error menyimpan file"}}};function f(r,i){const t=r.includes(",")?r.split(",")[1]:r,s=atob(t),e=[];for(let n=0;n<s.length;n+=512){const a=s.slice(n,n+512),p=new Array(a.length);for(let o=0;o<a.length;o++)p[o]=a.charCodeAt(o);const m=new Uint8Array(p);e.push(m)}return new Blob(e,{type:i})}function h(r){var t;switch(((t=r.split(".").pop())==null?void 0:t.toLowerCase())||""){case"csv":return"text/csv";case"xlsx":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"xls":return"application/vnd.ms-excel";case"pdf":return"application/pdf";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"txt":return"text/plain";default:return"application/octet-stream"}}export{h as getMimeType,g as saveFile};
